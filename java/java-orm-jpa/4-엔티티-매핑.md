## 4. 엔티티 매핑

### 엔티티 매핑 소개
- 객체와 테이블을 매핑하는 법
    - `@Entity`, `@Table`
- 필드와 컬럼 매핑
    - `@Column`
- 기본 키 매핑
    - `@Id`
- 연관관계 매핑
    - `@ManyToOne`, `@JoinColumn`

### 객체와 테이블 매핑
1. `@Entity`
    - `@Entity`가 붙은 클래스는 JPA가 관리하는 엔티티임
    - JPA를 사용할 테이블과 매핑할 클래스는 `@Entity`가 필수임
    - 스펙
        1. 기본 생성자 필수(파라미터 없는 `public`, `protected`)
        2. final 클래스, enum, interface, inner 클래스 사용 불가
        3. 저장할 필드에 final 사용할 수 없음
    ```java
    
    ```
2. `@Table`
    - 엔티티와 매핑할 테이블을 지정함
        ```java
        @Entity
        @Table(name = "MBR")
        public class Member {
            @Id
            private Long id;
            // ...
        }
        ```
    - `em.find(Member.class, 1L)` == `Select * from MBR where id = 1`

### 데이터베이스 스키마 자동 생성(ddl-auto)
> hibernate.hbm2ddl.auto=create
- DDL을 애플리케이션 실행 시점에 처리해줌
    - DDL = { create, alter, drop, truncate }
- 데이터베이스 방언을 활용해서 데이터베이스에 맞는 적절한 DDL을 사용해줌
    - 이렇게 생성된 DDL은 **개발 장비에서만 사용할 것**
- ddl-auto에는 5가지 종류의 속성이 있음
    1. create
        - 기본 테이블 **삭제(drop)** 후 다시 생성(create)
    2. create-drop
        - create + 종료 시점에 drop
    3. update
        - 변경분만 반영함 
    4. validate
        - 엔티티와 테이블이 **정상 매핑되어있는지만 확인**
    5. none(default)
        - ddl-auto 사용하지 않음
- **운영 장비에는 절대 create, create-drop, update를 사용하지 말 것!!**
    - 이론상 권장사항은 다음과 같음
        1. 개발 초기에는 create 또는 update
        2. 테스트 서버에는 update 또는 validate
        3. 스테이징과 운영 서버는 validate 또는 none
    - 로컬 PC에서만 create를 쓸 것을 권장함
- DDL 생성 기능(create, create-drop)에 사용되는 애노테이션
    - DDL 생성 기능은 DDL을 자동 생성할 때만 사용, **테이블에만 영향을 줌**
    - JPA의 실행 로직에는 영향을 주지 않음
    - `@Column(nullable = false, length = 10)`
        - = 회원 이름은 **필수**, 10자 제한
    - 유니크 제약조건 추가 
        - `@Table(uniqueConstraints = {@UniqueConstraint( name = "NAME_AGE_UNIQUE", columnNames = {"NAME", "AGE"} )})`
    

--- 
## 다음 글 

### 5. [연관관계 매핑 기초](5-연관관계-매핑-기초.md)
